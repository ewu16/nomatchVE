% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/estimate_nomatch_ci.R
\name{estimate_nomatch_ci}
\alias{estimate_nomatch_ci}
\title{Estimate bootstrapped confidence intervals for proposed VE estimator}
\usage{
estimate_nomatch_ci(
  data,
  outcome_time,
  outcome_status,
  exposure,
  exposure_time,
  covariates,
  weights_source,
  eval_times,
  censor_time,
  tau,
  gp_list,
  ci_type,
  limit_type = "limit",
  boot_reps,
  pt_est = NULL,
  alpha = 0.05,
  keep_boot_samples = TRUE,
  n_cores = 1
)
}
\arguments{
\item{data}{A data frame with one row per individual containing the columns
named in \code{outcome_time}, \code{outcome_status}, \code{exposure}, \code{exposure_time}, and any
variables listed in \code{covariates}.}

\item{outcome_time}{Name of the time-to-event/censoring variable. Time should
be measured from a given time origin (e.g. study start, enrollment, or age)
for all individuals.}

\item{outcome_status}{Name of the event indicator. The underlying column should be
numeric (\code{1} = event, \code{0} = censored).}

\item{exposure}{Name of the exposure indicator. The underlying column should
be numeric (\code{1} = exposed during follow-up, \code{0} = never exposed during
follow-up).}

\item{exposure_time}{Name of the time to exposure, measured from the chosen time
origin; use \code{NA} if not exposed. Time must be measured in the same units
(e.g. days) as that used for  \code{outcome_time}.}

\item{covariates}{Character vector of covariates to adjust for when fitting
the hazard models. These covariates should include all known confounders of
exposure and censoring measured at the chosen time origin.}

\item{weights_source}{Character string specifying the type of marginalizing weights
to use. Either:
\itemize{
\item \code{"observed"} (default): set the marginalizing weights to the empirical
distribution of exposure eval_times and covariates among the exposed. This
provides close alignment with the weights implicitly used in matching.
\item \code{"custom"}: use the user-specified weights provided in the \code{custom_weights} argument.
}}

\item{eval_times}{Numeric vector specifying the timepoints at which to compute
cumulative incidence and the derived effect measures. The timepoints should
be expressed in terms of time since exposure. All values must be greater
than \code{tau} and and should correspond to clinically meaningful follow-up
durations, such as 30, 60, or 90 days after exposure. A fine grid of
timepoints (e.g., \code{eval_times = (tau+1):100}) can be provided if cumulative
incidence curves over time are desired.}

\item{tau}{Non-negative numeric value specifying the time after exposure that
should be excluded from the risk evaluation period. This argument is
primarily intended for vaccination exposures, where it is common to exclude
the time after vaccination when immunity is still building. Time must be
measured in the same units as that used for \code{outcome_time} and \code{exposure_time}
and should reflect the biological understanding of when vaccine-induced
immunity develops (usually 1-2 weeks). For non-vaccine exposures, \code{tau} can
be set to 0 (no delay period).}

\item{gp_list}{List of two dataframes named \code{g_weights} and \code{p_weights} representing
the marginalizing distributions to use.}

\item{ci_type}{Method for constructing bootstrap confidence intervals. One of
\code{"wald"}, \code{"percentile"}, or \code{"both"}.
\itemize{
\item \code{"wald"} (default): Computes Wald-style intervals using bootstrap standard errors.
See \strong{Confidence intervals} section for details.
\item \code{"percentile"}: Computes percentile bootstrap intervals.
\item \code{"both"}: Computes and returns both sets of intervals.
}}

\item{boot_reps}{Number of bootstrap replicates for confidence intervals.
Recommended to use at least 1000 for publication-quality results. Use
smaller values (e.g., 10-100) for initial exploration. Default: \code{0} (no
bootstrapping).}

\item{pt_est}{A matrix of estimates. The columns of the matrix are the cumulative
incidence/VE terms and the rows are the requested timepoints for evaluation.}

\item{alpha}{Significance level for confidence intervals (Confidence level =
100*(1-\code{alpha})\%). Default: \code{0.05}.}

\item{keep_boot_samples}{Logical; return bootstrap samples? Default:
\code{TRUE}. Must be set to \code{TRUE} if user plans to use \code{\link[=add_simultaneous_ci]{add_simultaneous_ci()}}
to obtain simultaneous confidence intervals.}

\item{n_cores}{Integer; parallel cores for bootstrapping. Passed to
\code{parallel::mclapply} as \code{mc.cores}. On Unix-like OS only; not available on
Windows. Default: \code{1}.}

\item{boot_formula_0}{A formula for estimating hazards in
unvaccinated group for bootstrap samples (not a model)}

\item{boot_formula_1}{A formula for estimating hazards in
vaccinated group for bootstrap samples (not a model)}

\item{matched_data}{A data frame representing the matched cohort}
}
\value{
A list containing the following:
\describe{
\item{ci_estimates}{A list of matrices containing the lower and upper confidence interval bounds and
bootstrap standard error for each term. When \code{ci_type = "wald"}, the bootstrapped standard errors
on the transformed scale are also included.}
\item{n_success_boot}{The number of bootstrap samples used to compute confidence interval}
\item{boot_samples}{A matrix containing estimates from all bootstrap replications. Rows
represent bootstrap iterations, columns the term estimated.}
}
}
\description{
Estimate bootstrapped confidence intervals for proposed VE estimator
}
\keyword{internal}
